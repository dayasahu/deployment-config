enable kubernets engine , read offical doc and deploy dashboard ui .
we install using helm 
frst install help go to helm , bew or linux and chocleete for windows 
verify helm version
 

kubectl config use-context docker-desktop


https://docs.docker.com/desktop/use-desktop/kubernetes/#cluster-provisioning-method


https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/


 to insatll dashboard ui - choclaty palcag emanager and then helm 
 
 
 Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
 
 
 
 choco install kubernetes-helm
 
 helm repo add kubernetes-dashboard https://kubernetes.github.io/dashboard/
 
 helm upgrade --install kubernetes-dashboard kubernetes-dashboard/kubernetes-dashboard --create-namespace --namespace kubernetes-dashboard
 
 kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443
 
 https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md
 
 
 kubectl -n kubernetes-dashboard create token admin-user
 
kubectl get secret admin-user -n kubernetes-dashboard -o jsonpath="{.data.token}" `
| %{ [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($_)) }


eyJhbGciOiJSUzI1NiIsImtpZCI6IjRpdVRieG9KbmlpcG8tdmZzdlE3Z2szTTVRck1KZS16SEphVDctckp3VFUifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIyYmI3Y2JkOS00ZjExLTRiZDAtOTRiNC01ZTEwZWMyZDJmNjYiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.IwQPt8pcqt8tBauI1GKL6q6YwzhiixehAyIPQVFiJrFVLMba4X_BoAT6yLiuWbWCyagAa172jkY6gJQ2FbJMOTyQ_87rcDesEZiDgLivlCfvmj21VaG0eMBLZEKtG7YXnp3f6uLZcw7jyCjl37PD3TE3Oqb2s3MsqewHtwbps3AYIPc_sRWbS_MGSSJv1WacxnbOqByzSNvWnHG1PlsvsJ5wFu-Lo_GZXC0sLBwPhNhvxjJ7eedzgjD0WhW4iCJ_s-Rl8rNt3sL2kxylGHTotgsIN0Mi8kcZrvjZEsbEJ8yQYwrB9z6xT7U1CQtFYYNcRgNbypu8KCgkc-AEnM0MeA

 
 Stragler fig pattern 
 
 
 docker build . -t dayasahu6077/employee:v25dec
 
 >docker run -d -p 8080:8080 dayasahu6077/employee:v1
 
 
 spring.config.import=configserver:http://localhost:8071;spring.profiles.active=dev;spring.application.name=employee
 
 
 docker build . -t dayasahu6077/department:v2
 docker push dayasahu6077/department:v2
 
 docker compose up -d
 
 ##########
 -Dspring.profiles.active=dev
 spring.config.import=configserver:http://localhost:8071;spring.profiles.active=dev;spring.application.name=employee

 -Dspring.profiles.active=dev
 spring.config.import=configserver:http://localhost:8071;spring.profiles.active=dev;spring.application.name=department
 
 spring.config.import=configserver:http://localhost:8071;spring.profiles.active=dev;spring.application.name=employee
 
 #############
 docker build . -t dayasahu6077/configserver:v25dec
 docker build . -t dayasahu6077/department:v25dec
 docker build . -t dayasahu6077/employee:v25dec
 
 docker run -d -p 8072:8072 dayasahu6077/employee:v25dec
 docker run -d -p 8072:8080 dayasahu6077/configserver:v25dec
 
 docker run -d -p 8072:8071 dayasahu6077/configserver:v25dec
 
 docker run -d -p 8071:8071 -v D:\1_GITHUB\microservices-training\config\props:/config-repo:ro -e SPRING_CLOUD_CONFIG_SERVER_NATIVE_SEARCH_LOCATIONS="file:/config-repo/employee/,file:/config-repo/department/" --name configserver_local my/configserver:latest

 docker run -p 8071:8071 \
  -v D:/1_GITHUB/microservices-training/config/props:/config \
  configserver
  
  docker run -d -p 8071:8071 -v D:/1_GITHUB/microservices-training/config/props:/config dayasahu6077/configserver:v26dec configserver
  
  run with a name to integrate it with the networking 
  
  docker run -d --name configserver -p 8071:8071 -v D:/1_GITHUB/microservices-training/config/props:/config dayasahu6077/configserver:v26dec

 docker run -d --name employee --link configserver -p 8081:8080 -e SPRING_CONFIG_IMPORT=configserver:http://configserver:8071 -e SPRING_PROFILES_ACTIVE=dev -e SPRING_APPLICATION_NAME=employee dayasahu6077/employee:v26dec2am

////

version: "3.9"

services:
  configserver:
    image: dayasahu6077/configserver:v26dec
    ports:
      - "8071:8080"
    volumes:
      - D:/1_GITHUB/microservices-training/config/props:/config

  employee:
    image: dayasahu6077/employee:v26dec
    ports:
      - "8081:8080"
    environment:
      SPRING_CONFIG_IMPORT: configserver:http://configserver:8080
      SPRING_PROFILES_ACTIVE: dev
      SPRING_APPLICATION_NAME: employee
    depends_on:
      - configserver
///


kubectl get services
kubectl get replicaset
kubectl get deployments

create config map - 
kubectl apply -k services/employee/overlays/dev
kubectl apply -f configserver.yml


cluster ip node port 

kubectl get pods
kubectl get deployments
kubectl delete deployment configserver
kubectl rollout restart deployment configserver

D:\1_GITHUB\microservices-training\deployment-config\kubernetes>kubectl apply -f configserver/
deployment.apps/configserver created
service/configserver configured

**tekton***

kubectl apply -f https://storage.googleapis.com/tekton-releases/pipeline/latest/release.yaml

kubectl apply -f https://storage.googleapis.com/tekton-releases/dashboard/latest/release.yaml

kubectl create secret docker-registry dockerhub-secret --docker-username=YOUR_USERNAME   --docker-password=YOUR_TOKEN \
  --docker-email=you@example.com

kubectl port-forward -n tekton-pipelines svc/tekton-dashboard 9097:9097

kubectl create secret docker-registry dockerhub-secret --docker-username=dayasahu6077 --docker-password=test# --docker-email=dayashankarsahuch@gmail.com

create in teckton name space 

kubectl apply -n tekton-pipelines -f tekton/task-git-clone.yaml.yaml
kubectl apply -n tekton-pipelines -f tekton/task-maven-build.yaml
kubectl apply -n tekton-pipelines -f tekton/task-docker-build-push.yaml
kubectl apply -n tekton-pipelines -f tekton/pipeline-employee-ci.yaml

kubectl apply -n tekton-pipelines -f tekton/pipelinerun-employee-ci.yaml


kubectl get pipelines -n tekton-pipelines

kubectl create secret docker-registry dockerhub-secret --docker-username=dayasahu6077 --docker-password=xyz# --docker-email=dayashankarsahuch@gmail.com -n tekton-pipelines

** verify **
 kubectl get task,pipeline,pipelinerun,secret -n tekton-pipelines
 
maven-build         10m
PS D:\1_GITHUB\microservices-training\employee> kubectl get task,pipeline,pipelinerun,secret -n tekton-pipelines
NAME                                AGE
task.tekton.dev/docker-build-push   11m
task.tekton.dev/maven-build         11m

NAME                              AGE
pipeline.tekton.dev/employee-ci   11m

NAME                                     SUCCEEDED   REASON               STARTTIME   COMPLETIONTIME
pipelinerun.tekton.dev/employee-ci-run   False       CouldntGetPipeline   11m         11m

NAME                      TYPE                             DATA   AGE
secret/dockerhub-secret   kubernetes.io/dockerconfigjson   1      7m12s
secret/webhook-certs      Opaque                           3      89m
***8

employee-ci-run-maven
PodAdmissionFailed

kubectl label namespace tekton-pipelines pod-security.kubernetes.io/enforce=privileged pod-security.kubernetes.io/audit=privileged pod-security.kubernetes.io/warn=privileged --overwrite



kubectl delete pipelinerun -n tekton-pipelines employee-ci-run-maven
kubectl apply -f tekton/pipelinerun-employee-ci.yaml

kubectl delete pipelinerun employee-ci-run -n tekton-pipelines
kubectl delete pipeline employee-ci -n tekton-pipelines
kubectl delete task maven-build -n tekton-pipelines
kubectl delete task docker-build-push -n tekton-pipelines
kubectl delete task git-clone -n tekton-pipelines

kubectl apply -n tekton-pipelines -f tekton/task-git-clone.yaml
kubectl apply -n tekton-pipelines -f tekton/task-maven-build.yaml
kubectl apply -n tekton-pipelines -f tekton/task-docker-build-push.yaml
kubectl apply -n tekton-pipelines -f tekton/pipeline-employee-ci.yaml


kubectl create -n tekton-pipelines -f tekton/pipelinerun-employee-ci.yaml

if github private

kubectl create secret generic github-token \
  --from-literal=token=ghp_xxxxxxxxx \
  -n tekton-pipelines
error checking push permissions -- make sure you entered the correct tag name, and that you are authenticated correctly, and try again: checking push permission for "dayasahu6077/employee:20250106-1": POST https://index.docker.io/v2/dayasahu6077/employee/blobs/uploads/: UNAUTHORIZED: authentication required; [map[Action:pull Class: Name:dayasahu6077/employee Type:repository] map[Action:push Class: Name:dayasahu6077/employee Type:repository]]

kubectl apply -n tekton-pipelines -f tekton/tekton-build-sa.yaml
kubectl describe taskrun employee-ci-run-t68r7-clone -n tekton-pipelines

kubectl delete pipelinerun -n tekton-pipelines --all
kubectl create -f tekton/pipelinerun-employee-ci.yaml

  the step "clone" in TaskRun "employee-ci-run-kkbtl-clone" failed to pull the image "". The pod errored with the message: "Back-off pulling image "ghcr.io/tektoncd/git-init:v0.52.0": ErrImagePull: Error response from daemon: error from registry: denied
  

kubectl create secret docker-registry ghcr-pull-secret --docker-server=ghcr.io --docker-username=dayasahu6077 --docker-password=test# --docker-email=you@example.com  -n tekton-pipelines


kubectl apply -n tekton-pipelines -f tekton/tekton-sa-build.yaml


kubectl apply -n tekton-pipelines -f tekton/tekton-ci-sa.yaml

kubectl create secret docker-registry dockerhub-secret --docker-username=dayasahu6077 --docker-password=test --docker-email=dayashankarsahuch@gmail.com -n tekton-pipelines

kubectl get secret dockerhub-secret -n tekton-pipelines -o jsonpath='{.data.\.dockerconfigjson}' | base64 -d


kubectl create secret docker-registry dockerhub-secret   --docker-server=https://index.docker.io/v1/ --docker-username=dayasahu6077 --docker-password=pattoken --docker-email=dayashankarsahuch@gmail.com -n tekton-pipelines

kubectl get secret dockerhub-secret -n tekton-pipelines -o jsonpath='{.data.\.dockerconfigjson}' | base64 -d
******
Auto trigger build
kubectl apply -f https://storage.googleapis.com/tekton-releases/triggers/latest/release.yaml
kubectl apply -n tekton-pipelines -f tekton/triggerbinding-github.yaml
kubectl apply -n tekton-pipelines -f tekton/triggertemplate-employee.yaml
kubectl apply -n tekton-pipelines -f tekton/eventlistener-github.yaml

kubectl port-forward svc/el-github-listener 8080:8080 -n tekton-pipelines

kubectl expose svc el-github-listener --type=NodePort --name=github-webhook -n tekton-pipelines

http://192.168.1.6:8080

http://58.84.61.239:8080

****
kubectl create -f tekton/pipelinerun-employee-ci.yaml
kubectl apply -f .\deployment.yaml
kubectl apply -f .\service.yaml
kubectl rollout restart deployment employee


**** Tekton deploy step added

kubectl apply -f tekton/tekton-deploy-sa.yaml
kubectl apply -f tekton/tekton-deploy-rbac.yaml
kubectl apply -f tekton/tekton-ci-deploy-rbac.yaml
kubectl auth can-i update deployments --as=system:serviceaccount:tekton-pipelines:tekton-ci-sa  -n default
kubectl auth can-i update deployment/employee --as=system:serviceaccount:tekton-pipelines:tekton-ci-sa -n default
kubectl auth can-i patch deployment/employee --as=system:serviceaccount:tekton-pipelines:tekton-ci-sa -n default

kubectl apply -n tekton-pipelines -f tekton/pipeline-employee-ci.yaml

kubectl apply -n tekton-pipelines -f tekton/task-kubectl-deploy.yaml
kubectl delete pipelinerun -n tekton-pipelines --all

***** Install and setup Promethese and grafana **
add dependancy in pom and add property in pom 

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update
helm install prometheus prometheus-community/kube-prometheus-stack -n monitoring --create-namespace

kubectl port-forward svc/prometheus-grafana 3000:80 -n monitoring

http://localhost:3000/login

username: admin
password: prom-operator

login to find from secret - 

admin/RukccMlU86q5kUMqd0HUgbETuUoBJeHvpS1u57e9

